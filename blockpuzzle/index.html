<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Puzzle</title>
    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MJPN92FN');</script>
    <!-- End Google Tag Manager -->

    <link rel="stylesheet" href="style.css?v=1.0.0">

    <!-- SEO 최적화 -->
    <meta name="keywords" content="Block Puzzle, 블록 퍼즐, Brain Game, 두뇌 게임, Puzzle Strategy, 퍼즐 전략, Casual Game, 캐주얼 게임, Block Fitting, 블록 맞추기, Time Killer, 시간 떼우기, Logic Game, 논리 게임, Free Puzzle, 무료 퍼즐, Online Puzzle, 온라인 퍼즐">
    <meta name="description" content="전략적인 블록 배치로 고득점을 노려보세요! 2D 블록 퍼즐 게임으로 공간 인지력과 문제 해결 능력을 키울 수 있는 중독성 강한 퍼즐 게임">
    <meta name="author" content="COCY.IO">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Block Puzzle Master - COCY.IO">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://game.cocy.io/blockpuzzle/icons.svg">
    <meta property="og:url" content="https://game.cocy.io/blockpuzzle/">
    <meta property="og:description" content="도전적인 블록 배치 게임! 최고 점수를 달성하고 친구들과 경쟁해보세요">

    <!-- PWA 필수 메타태그 추가 -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icons/icon.svg">
</head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MHYFCQ35XR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MHYFCQ35XR');
</script>
<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MJPN92FN"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="difficulty-picker">
        <button class="difficulty-btn" data-level="beginner" data-size="3">■</button>
        <button class="difficulty-btn active" data-level="intermediate" data-size="4">■</button>
        <button class="difficulty-btn" data-level="advanced" data-size="5">■</button>
        <button class="difficulty-btn" data-level="chaos" data-size="?">■</button>
    </div>
    <div class="game-container">
        <div class="score">
            Score: <span id="score">0</span>
            <div class="time-display">⏰ 0s</div>
            <div class="button-container">
                <button class="auto-demo-btn" onclick="startAutoDemo()">🤖</button>
                <button class="trophy-btn" onclick="toggleScoreboard(event)">🏆</button>
            </div>
        </div>
        <div id="board" class="board"></div>
        <div id="block-container" class="block-container"></div>
    </div>

    <!-- 테스트 패널 (실제 게임에는 노출되지 않음) -->
    <div class="test-panel">
        <button onclick="setupComboTest()">콤보 테스트</button>
        <button onclick="setupCrossTest()">크로스 테스트</button>
        <button onclick="setupGameClearTest()">클리어 테스트</button>
        <button onclick="toggleAutoPlay()">자동플레이 ${isAutoPlaying ? '중지' : '시작'}</button>
        <button onclick="resetScoreboard()">기록 초기화</button> <!-- 추가 -->
    </div>

    <!-- 힌트 패널 수정 -->
    <div class="hint-panel">
        <button onclick="refreshBlocks()">🔄</button>
        <button onclick="rotateCurrentBlocks()">↻</button>
        <button onclick="showPossiblePlacement()">💡</button>
    </div>

    <!-- 게임 오버 팝업 (초기 숨김) -->
    <div id="gameOverPopup" class="game-over-popup" style="display: none;">
        <h2 id="popupTitle">GAME OVER</h2>
        <p>Level: <span id="popupLevel">${currentLevel.toUpperCase()}</span></p>
        <p>Score: <span id="popupScore">0</span></p>
        <p>Time: <span id="popupTime">0</span>s</p>
        <button onclick="resetGame()">Play Again</button>
    </div>

    <!-- 스코어보드 추가 -->
    <div id="scoreboard" class="scoreboard-popup">
        <h3>Best Records</h3>
        <div id="scoreList"></div>
    </div>

    <!-- 푸터 위치 수정 -->
    <footer style="
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0,0,0,0.7);
        color: white;
        padding: 10px;
        text-align: center;
        z-index: 100;
    ">
        © 2025 COCY.IO All rights reserved.
    </footer>
    <script src="script.js?v=1.0.0"></script>

</body>
</html>
