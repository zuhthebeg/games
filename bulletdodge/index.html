<!DOCTYPE html>
<html lang="ko">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!="dataLayer"?"&l="+l:"";j.async=true;j.src="https://www.googletagmanager.com/gtm.js?id="+i+dl;f.parentNode.insertBefore(j,f)})(window,document,"script","dataLayer","GTM-MV8KQGJF");</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ğŸ’¥ ì´ì•Œ í”¼í•˜ê¸°</title>
    <link rel="icon" href="icon.svg">
    <script src="/lib/shared-wallet.js?v=20260211"></script>
    <script src="/lib/multiplayer.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #080818; overflow: hidden; }

        /* kaplay ìº”ë²„ìŠ¤ ì»¨í…Œì´ë„ˆ â€” letterboxê°€ position:absoluteë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ relative í•„ìˆ˜ */
        #game-wrap {
            position: fixed;
            top: calc(48px + env(safe-area-inset-top));
            left: 0; right: 0; bottom: 0;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
        }
        canvas { display: block; touch-action: none; max-width: 100%; }

        /* â”€â”€ Joystick â”€â”€ */
        #joyWrap {
            position: fixed; bottom: 28px; right: 20px;
            width: 120px; height: 120px;
            z-index: 50; display: none; touch-action: none;
        }
        #joyBase {
            position: absolute; inset: 0; border-radius: 50%;
            background: rgba(255,255,255,0.07);
            border: 2px solid rgba(255,255,255,0.18);
        }
        #joyKnob {
            position: absolute; width: 52px; height: 52px;
            border-radius: 50%;
            background: rgba(0,210,255,0.50);
            border: 2px solid rgba(0,230,255,0.85);
            top: 34px; left: 34px;
            will-change: transform; pointer-events: none;
        }

        /* â”€â”€ Overlay (lobby / waiting) â”€â”€ */
        #overlay {
            position: fixed; inset: 0; z-index: 200;
            display: none; flex-direction: column;
            align-items: center; justify-content: center;
            background: rgba(0,0,0,0.9);
            padding: calc(52px + env(safe-area-inset-top)) 16px 16px;
        }
        .panel {
            background: #0d0d24;
            border: 1.5px solid #2244aa;
            border-radius: 14px;
            padding: 22px 20px;
            width: 100%; max-width: 320px;
            text-align: center;
            font-family: monospace; color: #eee;
        }
        .panel h2 { font-size: 20px; margin-bottom: 14px; }
        .inp {
            width: 100%; padding: 10px 12px;
            background: #141430; border: 1px solid #3355cc;
            border-radius: 8px; color: #eee;
            font-family: monospace; font-size: 15px;
            margin-bottom: 10px; outline: none;
        }
        .inp::placeholder { color: #556; }
        .inp:focus { border-color: #5588ff; }
        .inp.code { text-transform: uppercase; letter-spacing: 4px;
            font-size: 18px; text-align: center; }
        .btn {
            display: block; width: 100%; padding: 12px;
            border-radius: 8px; border: none; cursor: pointer;
            font-family: monospace; font-size: 16px;
            font-weight: bold; margin-bottom: 8px;
            transition: opacity .15s;
        }
        .btn:active { opacity: .75; }
        .btn:disabled { opacity: .4; cursor: default; }
        .btn-primary  { background: #1a90d0; color: #fff; }
        .btn-green    { background: #1a9050; color: #fff; }
        .btn-ghost    { background: #1a1a3a; color: #99aacc; border: 1px solid #2244aa; }
        .btn-danger   { background: #8a2020; color: #fcc; }
        .divider { color: #445; font-size: 13px; margin: 4px 0 10px; }
        .errmsg { color: #f88; font-size: 13px; margin-top: 6px; min-height: 18px; }
        .player-row {
            display: flex; align-items: center; gap: 8px;
            padding: 7px 10px; border-radius: 6px;
            margin-bottom: 6px; background: #111130;
            font-size: 14px;
        }
        .player-row .dot { width: 8px; height: 8px; border-radius: 50%; }
        .room-code-big {
            font-size: 32px; font-weight: bold; color: #ffd700;
            letter-spacing: 6px; margin: 8px 0;
        }
    </style>
</head>
<body>

<div id="game-wrap"></div>
<div id="joyWrap"><div id="joyBase"></div><div id="joyKnob"></div></div>
<div id="overlay"><div id="overlayContent"></div></div>

<script src="https://unpkg.com/kaplay@4000.0.0-alpha.26/dist/kaplay.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Joystick
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const joyWrap = document.getElementById("joyWrap");
const joyKnob = document.getElementById("joyKnob");
const JOY_MAX = 48;
let joyX = 0, joyY = 0, joyTouchId = null, joyCX = 0, joyCY = 0;

function joyShow() { joyWrap.style.display = "block"; }
function joyHide() { joyWrap.style.display = "none";  }
function joyCenter() { const r = joyWrap.getBoundingClientRect(); return { x: r.left + r.width/2, y: r.top + r.height/2 }; }
function joyApply(dx, dy) {
    const len = Math.sqrt(dx*dx+dy*dy);
    const nx = len>JOY_MAX ? dx/len*JOY_MAX : dx;
    const ny = len>JOY_MAX ? dy/len*JOY_MAX : dy;
    joyKnob.style.transform = `translate(${nx}px,${ny}px)`;
    joyX = nx/JOY_MAX; joyY = ny/JOY_MAX;
}
function joyReset() { joyKnob.style.transform="translate(0,0)"; joyX=0; joyY=0; joyTouchId=null; }

document.addEventListener("touchstart", e => {
    if (joyWrap.style.display==="none") return;
    for (const t of e.changedTouches) {
        if (joyTouchId!==null) continue;
        const c = joyCenter(), dx=t.clientX-c.x, dy=t.clientY-c.y;
        if (Math.sqrt(dx*dx+dy*dy)<90) { joyTouchId=t.identifier; joyCX=c.x; joyCY=c.y; joyApply(dx,dy); e.preventDefault(); }
    }
}, { passive:false });
document.addEventListener("touchmove", e => {
    for (const t of e.changedTouches)
        if (t.identifier===joyTouchId) { joyApply(t.clientX-joyCX, t.clientY-joyCY); e.preventDefault(); }
}, { passive:false });
document.addEventListener("touchend",    e => { for (const t of e.changedTouches) if (t.identifier===joyTouchId) joyReset(); });
document.addEventListener("touchcancel", e => { for (const t of e.changedTouches) if (t.identifier===joyTouchId) joyReset(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Seeded RNG (mulberry32)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function makePRNG(seed) {
    let s = seed >>> 0;
    return function rng() {
        s += 0x6D2B79F5;
        let t = Math.imul(s ^ (s >>> 15), 1 | s);
        t = t + Math.imul(t ^ (t >>> 7), 61 | t) ^ t;
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    };
}
function rngRange(rng, lo, hi) { return lo + rng() * (hi - lo); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Constants
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RELAY_URLì€ multiplayer.jsì—ì„œ ì „ì—­ ì„ ì–¸ë¨ (ì¤‘ë³µ ê¸ˆì§€)
const GAME_W      = 360;
const GAME_H      = 640;
const PLAYER_R    = 13;
const PLAYER_SPD  = 240;
const MAX_LIVES   = 3;
const INVINC_DUR  = 1.5;
const GOLD_SEC    = 10;
const BEST_KEY    = "bulletdodge_best";
const NICK_KEY    = "bulletdodge_nick";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Multiplayer State
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let mp = null;
let mpRoomId = null;
let mpIsHost  = false;
let mpContext = null;   // { opponents: [{id,nickname,ghostX,ghostY,alive}] }
const mpEventQueue = [];

function mpGetNick() { return localStorage.getItem(NICK_KEY) || ""; }
function mpSetNick(n) { localStorage.setItem(NICK_KEY, n); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Overlay helpers
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const overlay = document.getElementById("overlay");
const ovContent = document.getElementById("overlayContent");

function showOverlay(html) {
    ovContent.innerHTML = html;
    overlay.style.display = "flex";
}
function hideOverlay() {
    overlay.style.display = "none";
    ovContent.innerHTML = "";
}

// â”€â”€ Lobby â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showLobby() {
    showOverlay(`
        <div class="panel">
            <h2>ğŸ® ë©€í‹°í”Œë ˆì´</h2>
            <input id="nickInp" class="inp" placeholder="ë‹‰ë„¤ì„ (ìµœëŒ€ 10ì)" maxlength="10"
                value="${mpGetNick()}" autocomplete="off">
            <button class="btn btn-primary" onclick="doCreate()">ë°© ë§Œë“¤ê¸°</button>
            <div class="divider">â”€ ë˜ëŠ” â”€</div>
            <input id="codeInp" class="inp code" placeholder="ë°© ì½”ë“œ ì…ë ¥" maxlength="6" autocomplete="off">
            <button class="btn btn-ghost" onclick="doJoin()">ì°¸ê°€í•˜ê¸°</button>
            <button class="btn btn-ghost" style="margin-top:4px" onclick="hideOverlay()">ì·¨ì†Œ</button>
            <div id="lobbyErr" class="errmsg"></div>
        </div>
    `);
}

async function doCreate() {
    const nick = (document.getElementById("nickInp").value.trim() || "ìµëª…").slice(0, 10);
    mpSetNick(nick);
    setLobbyErr("ë°© ìƒì„± ì¤‘...", "#adf");
    try {
        mp = MultiplayerClient.getInstance();
        await mp.ensureAuth();
        await mp.setNickname(nick);
        const { roomId } = await mp.createRoom("bulletdodge", {});
        mpRoomId = roomId; mpIsHost = true;
        setupMpListeners();
        const state = await mp.getRoomState();
        showWaiting(state);
    } catch(e) { setLobbyErr("ì˜¤ë¥˜: " + (e.message || e)); }
}

async function doJoin() {
    const nick = (document.getElementById("nickInp").value.trim() || "ìµëª…").slice(0, 10);
    const code = (document.getElementById("codeInp").value.trim()).toUpperCase();
    if (!code || code.length < 4) { setLobbyErr("ë°© ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”"); return; }
    mpSetNick(nick);
    setLobbyErr("ì°¸ê°€ ì¤‘...", "#adf");
    try {
        mp = MultiplayerClient.getInstance();
        await mp.ensureAuth();
        await mp.setNickname(nick);
        await mp.joinRoom(code);
        mpRoomId = code; mpIsHost = false;
        setupMpListeners();
        const state = await mp.getRoomState();
        showWaiting(state);
    } catch(e) { setLobbyErr("ì˜¤ë¥˜: " + (e.message || e)); }
}

function setLobbyErr(msg, color) {
    const el = document.getElementById("lobbyErr");
    if (el) { el.textContent = msg; el.style.color = color || "#f88"; }
}

// â”€â”€ Waiting Room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showWaiting(state) {
    const roomId = state?.roomId || mpRoomId || "------";
    const players = state?.players || [];
    const canStart = mpIsHost && players.length >= 2;

    showOverlay(`
        <div class="panel">
            <h2>â³ ëŒ€ê¸° ì¤‘</h2>
            <div style="color:#888;font-size:12px;margin-bottom:4px">ë°© ì½”ë“œë¥¼ ì¹œêµ¬ì—ê²Œ ì•Œë ¤ì£¼ì„¸ìš”</div>
            <div class="room-code-big" id="codeDisplay">${roomId}</div>
            <button class="btn btn-ghost" style="padding:6px;font-size:12px;margin-bottom:12px"
                onclick="navigator.clipboard?.writeText('${roomId}').then(()=>{this.textContent='ë³µì‚¬ë¨ âœ“';setTimeout(()=>{this.textContent='ì½”ë“œ ë³µì‚¬'},1200)}).catch(()=>{})">ì½”ë“œ ë³µì‚¬</button>

            <div id="playerList" style="margin-bottom:12px">
                ${players.map(p => `
                    <div class="player-row">
                        <div class="dot" style="background:${p.isHost?'#ffd700':'#5599ff'}"></div>
                        <span>${p.isHost?'ğŸ‘‘ ':''}${p.nickname||'ìµëª…'}</span>
                        ${p.userId===mp?.userId?'<span style="margin-left:auto;font-size:11px;color:#aaa">(ë‚˜)</span>':''}
                    </div>`).join("")}
            </div>

            ${mpIsHost
                ? `<button class="btn btn-green" id="startBtn" ${canStart?'':'disabled'}
                      onclick="doStart()">${canStart?'ê²Œì„ ì‹œì‘ â–¶':'í”Œë ˆì´ì–´ ëŒ€ê¸° ì¤‘...'}</button>`
                : `<div style="color:#888;font-size:14px;margin-bottom:12px">ë°©ì¥ì´ ì‹œì‘í•˜ë©´ ê²Œì„ì´ ì‹œì‘ë©ë‹ˆë‹¤</div>`}
            <button class="btn btn-danger" onclick="doLeave()">ë‚˜ê°€ê¸°</button>
            <div id="waitErr" class="errmsg"></div>
        </div>
    `);
}

async function doStart() {
    const btn = document.getElementById("startBtn");
    if (btn) btn.disabled = true;
    try { await mp.startGame(); }
    catch(e) {
        const el = document.getElementById("waitErr");
        if (el) el.textContent = "ì˜¤ë¥˜: " + (e.message || e);
        if (btn) btn.disabled = false;
    }
}

async function doLeave() {
    try { await mp?.leaveRoom(); } catch {}
    mp?.stopListening();
    MultiplayerClient.resetInstance();
    mp = null; mpRoomId = null; mpIsHost = false; mpContext = null;
    mpEventQueue.length = 0;
    hideOverlay();
}

// â”€â”€ Multiplayer event listener setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setupMpListeners() {
    mp.onEvent = (type, data) => {
        // ëŒ€ê¸°ì‹¤ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” onStateChangeì—ì„œ ì²˜ë¦¬
        // ê²Œì„ ì¤‘ ì´ë²¤íŠ¸ íì‰
        if (type === "action" && data?.payload?.events) {
            for (const evt of data.payload.events) {
                mpEventQueue.push({ type: evt.type, playerId: evt.playerId, payload: evt.payload });
            }
        }
        if (type === "game_ended") {
            mpEventQueue.push({ type: "game_ended", payload: data?.payload || data });
        }
        if (type === "player_left") {
            mpEventQueue.push({ type: "player_left", payload: data });
        }
    };

    mp.onStateChange = (state) => {
        if (state?.status === "playing") {
            // ê²Œì„ ì‹œì‘!
            const seed = state.gameState?.seed ?? Math.floor(Math.random() * 0xFFFFFF);
            const myId = mp.userId;
            const opponents = (state.players || [])
                .filter(p => p.userId !== myId)
                .map(p => ({ id: p.userId, nickname: p.nickname || "ìµëª…", ghostX: 180, ghostY: 550, alive: true }));
            mpContext = { opponents };
            hideOverlay();
            joyHide();
            k.go("game", { mode: "multi", seed, mpCtx: mpContext });
        } else if (overlay.style.display !== "none") {
            // ëŒ€ê¸°ì‹¤ ê°±ì‹ 
            showWaiting(state);
        }
    };

    mp.startListening();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Misc helpers
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function getBest()   { return parseFloat(localStorage.getItem(BEST_KEY) || "0"); }
function saveBest(t) { localStorage.setItem(BEST_KEY, t.toFixed(1)); }
function dist2(a, b) { const dx=a.x-b.x, dy=a.y-b.y; return dx*dx+dy*dy; }

async function submitRanking(survTime) {
    try {
        let userId = null, nickname = null;
        if (mp?.userId) { userId = mp.userId; nickname = mp.userNickname || mpGetNick(); }
        if (!userId) {
            const stored = localStorage.getItem("mp_user");
            if (stored) { const u = JSON.parse(stored); userId = u.id; nickname = u.nickname; }
        }
        if (!userId) return;
        await fetch(`${RELAY_URL}/api/rankings/bulletdodge`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ userId, nickname, time: survTime }),
        });
    } catch {}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  KaplayJS Init
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// canvas ìƒì„± â†’ game-wrapì— ì‚½ì…, CSSë¡œ í¬ê¸° ë§ì¶¤
const gameWrap   = document.getElementById("game-wrap");
const gameCanvas = document.createElement("canvas");
gameWrap.appendChild(gameCanvas);

// game-wrap ê°€ìš© ì˜ì—­ì— ë§ì¶° canvas CSS í¬ê¸° ê²°ì • (ëª¨ë°”ì¼ ì£¼ì†Œì°½ ë³€í™” ëŒ€ì‘)
function resizeCanvas() {
    const aw = gameWrap.clientWidth  || window.innerWidth;
    const ah = gameWrap.clientHeight || Math.max(320, window.innerHeight - 48);
    const scale = Math.min(aw / GAME_W, ah / GAME_H, 1.8);
    gameCanvas.style.width  = Math.round(GAME_W * scale) + "px";
    gameCanvas.style.height = Math.round(GAME_H * scale) + "px";
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);
window.visualViewport?.addEventListener("resize", resizeCanvas);

const k = kaplay({
    canvas: gameCanvas,
    width: GAME_W, height: GAME_H,
    background: [8, 8, 24],
    debug: false,
    pixelDensity: Math.min(window.devicePixelRatio || 1, 2),
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TITLE SCENE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
k.scene("title", () => {
    joyHide(); hideOverlay();

    // Drifting bullets (decoration)
    for (let i = 0; i < 14; i++) {
        const obj = k.add([k.circle(k.rand(3,7)), k.pos(k.rand(0,GAME_W), k.rand(0,GAME_H)),
            k.anchor("center"), k.color(180,40,40), k.opacity(0.28)]);
        const vx = k.rand(-40,40), vy = k.rand(25,80);
        obj.onUpdate(() => {
            let nx = obj.pos.x + vx * k.dt();
            let ny = obj.pos.y + vy * k.dt();
            if (ny > GAME_H + 20) ny = -20;
            if (nx < -20) nx = GAME_W + 20;
            if (nx > GAME_W + 20) nx = -20;
            obj.pos = k.vec2(nx, ny);
        });
    }

    k.add([k.pos(GAME_W/2, GAME_H*0.14), k.anchor("center"),
        k.text("ğŸ’¥ ì´ì•Œ í”¼í•˜ê¸°", {size:26,font:"monospace"}), k.color(255,220,50)]);
    k.add([k.pos(GAME_W/2, GAME_H*0.22), k.anchor("center"),
        k.text("BULLET  DODGE", {size:14,font:"monospace"}), k.color(80,170,255)]);

    // Best time
    const best = getBest();
    if (best > 0) {
        k.add([k.pos(GAME_W/2, GAME_H*0.30), k.anchor("center"),
            k.text(`ğŸ† ë‚´ ìµœê³ : ${best.toFixed(1)}ì´ˆ`, {size:15,font:"monospace"}), k.color(255,190,60)]);
    }

    // Rankings box
    const rankBg = k.add([k.rect(GAME_W-24, 170), k.pos(12, GAME_H*0.37),
        k.color(5,5,20), k.opacity(0.75)]);
    k.add([k.pos(GAME_W/2, GAME_H*0.37+12), k.anchor("center"),
        k.text("ğŸ† ë­í‚¹ TOP 5", {size:13,font:"monospace"}), k.color(255,200,50)]);

    fetch(`${RELAY_URL}/api/rankings/bulletdodge?limit=5`)
        .then(r => r.json()).then(data => {
            const rows = data.rankings || [];
            if (!rows.length) {
                k.add([k.pos(GAME_W/2, GAME_H*0.37+90), k.anchor("center"),
                    k.text("ì•„ì§ ê¸°ë¡ ì—†ìŒ\në¨¼ì € í”Œë ˆì´í•´ë³´ì„¸ìš”!", {size:12,font:"monospace",align:"center"}),
                    k.color(100,120,150)]);
                return;
            }
            rows.forEach((r, i) => {
                const y = GAME_H*0.37 + 34 + i*26;
                const medal = ["ğŸ¥‡","ğŸ¥ˆ","ğŸ¥‰"][i] || `${i+1}.`;
                const nick = (r.nickname||"ìµëª…").slice(0,12);
                const col = i===0?[255,215,0]:i===1?[220,220,220]:i===2?[200,130,60]:[150,170,200];
                k.add([k.pos(20, y), k.anchor("left"),
                    k.text(`${medal} ${nick}`, {size:12,font:"monospace"}), k.color(...col)]);
                k.add([k.pos(GAME_W-20, y), k.anchor("right"),
                    k.text(`${r.best_time.toFixed(1)}s`, {size:12,font:"monospace"}), k.color(80,200,255)]);
            });
        }).catch(() => {});

    const btnW = Math.round(GAME_W * 0.56);
    const btn1H = 50;
    const btn2H = 46;
    const btnGap = Math.round(GAME_H * 0.022);
    const btn2Y = GAME_H - Math.round(GAME_H * 0.11);
    const btn1Y = btn2Y - (btn1H / 2 + btn2H / 2 + btnGap);

    // 1P button
    const btn1p = k.add([k.rect(btnW, btn1H), k.pos(GAME_W / 2, btn1Y),
        k.anchor("center"), k.color(20,150,200), k.area(), "btn1p"]);
    k.add([k.pos(GAME_W / 2, btn1Y), k.anchor("center"),
        k.text("â–¶  1ì¸ í”Œë ˆì´", {size:19,font:"monospace"}), k.color(255,255,255)]);

    // Multi button
    const btnMp = k.add([k.rect(btnW, btn2H), k.pos(GAME_W / 2, btn2Y),
        k.anchor("center"), k.color(80,40,150), k.area(), "btnMp"]);
    k.add([k.pos(GAME_W / 2, btn2Y), k.anchor("center"),
        k.text("ğŸ‘¥  ë©€í‹°í”Œë ˆì´", {size:17,font:"monospace"}), k.color(220,200,255)]);

    btn1p.onClick(() => k.go("game", { mode:"1p", seed: Math.floor(Math.random()*0xFFFFFF) }));
    btnMp.onClick(() => showLobby());
    k.onKeyDown("space", () => k.go("game", { mode:"1p", seed: Math.floor(Math.random()*0xFFFFFF) }));
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GAME SCENE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
k.scene("game", (data) => {
    const isMulti = data.mode === "multi";
    const rng     = makePRNG(data.seed ?? Math.floor(Math.random()*0xFFFFFF));
    const mpCtx   = data.mpCtx || null;

    joyShow();

    let lives      = MAX_LIVES;
    let survTime   = 0;
    let invinc     = 0;
    let goldTimer  = 0;
    let goldEarned = 0;
    let flashT     = 0, flashVis = true;
    let active     = true;

    // Position broadcast timer (multi only)
    let posTimer = 0;
    const POS_INTERVAL = 2.5;

    const bullets = []; // { obj, vx, vy, r }

    // Stars
    for (let i=0; i<40; i++) {
        k.add([k.circle(rng()*1.5+0.5), k.pos(rng()*GAME_W, 40+rng()*(GAME_H-40)),
            k.anchor("center"), k.color(200,220,255), k.opacity(rng()*0.4+0.1)]);
    }

    // Glow + Player
    const glow = k.add([k.circle(PLAYER_R+9), k.pos(GAME_W/2, GAME_H-90),
        k.anchor("center"), k.color(0,180,255), k.opacity(0.18)]);
    const player = k.add([k.circle(PLAYER_R), k.pos(GAME_W/2, GAME_H-90),
        k.anchor("center"), k.color(0,220,255), k.opacity(1)]);

    // â”€â”€ Ghost players (multi) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const ghosts = {};
    if (mpCtx) {
        const ghostColors = [[255,100,100],[100,255,150],[255,200,50],[200,100,255]];
        mpCtx.opponents.forEach((opp, idx) => {
            const gc = ghostColors[idx % ghostColors.length];
            const gObj = k.add([k.circle(PLAYER_R), k.pos(opp.ghostX, opp.ghostY),
                k.anchor("center"), k.color(...gc), k.opacity(0.38)]);
            const gGlow = k.add([k.circle(PLAYER_R+7), k.pos(opp.ghostX, opp.ghostY),
                k.anchor("center"), k.color(...gc), k.opacity(0.12)]);
            const gLabel = k.add([k.pos(opp.ghostX, opp.ghostY-PLAYER_R-14), k.anchor("center"),
                k.text(opp.nickname, {size:10,font:"monospace"}), k.color(...gc), k.opacity(0.7)]);
            ghosts[opp.id] = { obj:gObj, gGlow, label:gLabel, data:opp, color:gc };
        });
    }

    // â”€â”€ HUD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    k.add([k.rect(GAME_W,38), k.pos(0,0), k.color(0,0,0), k.opacity(0.65), k.fixed()]);

    const timeTxt  = k.add([k.pos(GAME_W/2,19), k.anchor("center"),
        k.text("0.0s",{size:20,font:"monospace"}), k.color(255,255,200), k.fixed()]);
    const livesTxt = k.add([k.pos(8,19), k.anchor("left"),
        k.text("â¤ï¸â¤ï¸â¤ï¸",{size:17,font:"monospace"}), k.color(255,70,70), k.fixed()]);
    const lvTxt    = k.add([k.pos(GAME_W-8,19), k.anchor("right"),
        k.text("LV 1",{size:13,font:"monospace"}), k.color(100,170,255), k.fixed()]);

    // Opponent status bar (multi)
    const oppBar = isMulti && mpCtx?.opponents.length
        ? k.add([k.pos(GAME_W/2, GAME_H-22), k.anchor("center"),
              k.text("", {size:11,font:"monospace"}), k.color(200,180,255), k.fixed()])
        : null;

    function updateHUD() {
        timeTxt.text = survTime.toFixed(1)+"s";
        livesTxt.text = "â¤ï¸".repeat(Math.max(0,lives));
        const lv = getLevel();
        lvTxt.text = `LV ${lv}`;
        const lvc = [[100,170,255],[255,200,50],[255,130,50],[255,50,50]][lv-1]||[255,50,50];
        lvTxt.color.r=lvc[0]; lvTxt.color.g=lvc[1]; lvTxt.color.b=lvc[2];
        if (oppBar && mpCtx) {
            const parts = mpCtx.opponents.map(o =>
                o.alive ? `${o.nickname} ğŸƒ` : `${o.nickname} ğŸ’€${(o.survivalTime||0).toFixed(1)}s`
            );
            oppBar.text = parts.join("  ");
        }
    }

    // â”€â”€ Difficulty â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function getLevel() {
        if (survTime<15) return 1; if (survTime<40) return 2; if (survTime<80) return 3; return 4;
    }
    function getSpawnInterval() { return Math.max(0.32, 1.6 - survTime*0.016); }
    function getBulletSpeed()   { return 140 + survTime*2.0 + getLevel()*30; }

    // â”€â”€ Bullets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let spawnTimer = 0;

    function edgePos() {
        const edge = Math.floor(rng()*4);
        if (edge===0) return {x:rngRange(rng,20,GAME_W-20), y:-14};
        if (edge===1) return {x:GAME_W+14, y:rngRange(rng,40,GAME_H-20)};
        if (edge===2) return {x:rngRange(rng,20,GAME_W-20), y:GAME_H+14};
                      return {x:-14, y:rngRange(rng,40,GAME_H-20)};
    }
    function addBullet(x,y,vx,vy,col,r) {
        const obj = k.add([k.circle(r), k.pos(x,y), k.anchor("center"), k.color(...col)]);
        bullets.push({obj,vx,vy,r});
    }
    function spawnNormal() {
        const {x,y}=edgePos(), spd=getBulletSpeed();
        const tx=rngRange(rng,GAME_W/2-70,GAME_W/2+70), ty=rngRange(rng,GAME_H/2-90,GAME_H/2+90);
        const dx=tx-x, dy=ty-y, len=Math.sqrt(dx*dx+dy*dy)||1;
        addBullet(x,y,dx/len*spd,dy/len*spd,[255,55,55],5);
    }
    function spawnAim() {
        const {x,y}=edgePos(), spd=getBulletSpeed();
        const dx=player.pos.x-x, dy=player.pos.y-y, len=Math.sqrt(dx*dx+dy*dy)||1;
        addBullet(x,y,dx/len*spd,dy/len*spd,[255,160,30],5);
    }
    function spawnSpread() {
        const {x,y}=edgePos(), spd=getBulletSpeed();
        const base=Math.atan2(GAME_H/2-y,GAME_W/2-x);
        const count=getLevel()>=4?7:5;
        for (let i=0;i<count;i++) {
            const a=base+(i-Math.floor(count/2))*0.21;
            addBullet(x,y,Math.cos(a)*spd,Math.sin(a)*spd,[210,50,220],4);
        }
    }
    function pickAndSpawn() {
        const lv=getLevel(), r=rng();
        if      (lv===1) spawnNormal();
        else if (lv===2) { r<0.35?spawnAim():spawnNormal(); }
        else if (lv===3) { r<0.28?spawnSpread():r<0.55?spawnAim():spawnNormal(); }
        else             { r<0.32?spawnSpread():r<0.62?spawnAim():spawnNormal(); }
        if (lv>=3 && rng()<0.28) spawnAim();
        if (lv>=4 && rng()<0.22) spawnSpread();
    }

    // â”€â”€ Hit / Death â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showMsg(txt, col) {
        const t = k.add([k.pos(GAME_W/2,GAME_H/2-40), k.anchor("center"),
            k.text(txt,{size:18,font:"monospace",align:"center"}), k.color(...col), k.fixed()]);
        k.wait(2, () => { try { k.destroy(t); } catch {} });
    }

    function playerHit() {
        if (invinc>0||!active) return;
        lives=Math.max(0,lives-1); invinc=INVINC_DUR; flashT=0; flashVis=true;
        k.shake(9); updateHUD();
        if (lives<=0) { active=false; k.wait(0.9,()=>endGame()); }
    }

    function endGame() {
        joyHide();
        // Multi: notify server
        if (isMulti && mp) {
            mp.sendAction({ type:"died", payload:{ survivalTime: survTime } }).catch(()=>{});
        }
        // Submit ranking
        submitRanking(survTime);
        // Save local best
        if (survTime > getBest()) saveBest(survTime);

        const opponentResults = mpCtx
            ? mpCtx.opponents.map(o => ({ nickname: o.nickname, survivalTime: o.survivalTime || null }))
            : [];
        k.go("gameover", { survTime, goldEarned, isMulti, opponentResults });
    }

    // â”€â”€ Main Loop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    k.onUpdate(() => {
        if (!active) return;
        survTime  += k.dt();
        goldTimer += k.dt();
        while (goldTimer >= GOLD_SEC) {
            goldTimer -= GOLD_SEC; goldEarned += 10;
            if (typeof SharedWallet!=="undefined") SharedWallet.addGold(10);
        }

        // Invincibility flash
        if (invinc>0) {
            invinc-=k.dt(); flashT+=k.dt();
            if (flashT>=0.09) { flashT=0; flashVis=!flashVis; player.opacity=flashVis?1:0.12; glow.opacity=flashVis?0.18:0; }
            if (invinc<=0) { player.opacity=1; glow.opacity=0.18; }
        }

        // Movement
        let mx=0, my=0;
        if (k.isKeyDown("left")||k.isKeyDown("a"))  mx-=1;
        if (k.isKeyDown("right")||k.isKeyDown("d")) mx+=1;
        if (k.isKeyDown("up")||k.isKeyDown("w"))    my-=1;
        if (k.isKeyDown("down")||k.isKeyDown("s"))  my+=1;
        if (Math.abs(joyX)>0.08) mx+=joyX;
        if (Math.abs(joyY)>0.08) my+=joyY;
        const mlen=Math.sqrt(mx*mx+my*my); if (mlen>1){mx/=mlen;my/=mlen;}
        const nx = Math.max(PLAYER_R, Math.min(GAME_W - PLAYER_R, player.pos.x + mx * PLAYER_SPD * k.dt()));
        const ny = Math.max(40 + PLAYER_R + 4, Math.min(GAME_H - PLAYER_R, player.pos.y + my * PLAYER_SPD * k.dt()));
        player.pos = k.vec2(nx, ny);
        glow.pos = k.vec2(nx, ny);

        // Multi: broadcast position
        if (isMulti && mp) {
            posTimer += k.dt();
            if (posTimer >= POS_INTERVAL) {
                posTimer = 0;
                mp.sendAction({ type:"position", payload:{ x:Math.round(player.pos.x), y:Math.round(player.pos.y) } }).catch(()=>{});
            }
        }

        // Process multiplayer events
        while (mpEventQueue.length > 0) {
            const evt = mpEventQueue.shift();
            if (evt.type === "ghost_moved") {
                const g = ghosts[evt.playerId];
                if (g && g.data.alive) {
                    g.obj.pos   = k.vec2(evt.payload.x, evt.payload.y);
                    g.gGlow.pos = k.vec2(evt.payload.x, evt.payload.y);
                    g.label.pos = k.vec2(evt.payload.x, evt.payload.y - PLAYER_R - 14);
                }
            } else if (evt.type === "player_died") {
                const g = ghosts[evt.playerId];
                if (g) {
                    g.data.alive = false;
                    g.data.survivalTime = evt.payload.survivalTime;
                    k.destroy(g.obj); k.destroy(g.gGlow); k.destroy(g.label);
                    showMsg(`${evt.payload.nickname}\n${evt.payload.survivalTime.toFixed(1)}ì´ˆ ìƒì¡´`, [255,120,80]);
                }
            } else if (evt.type === "player_left") {
                const opp = mpCtx?.opponents.find(o => o.id === evt.payload?.userId);
                if (opp) { opp.alive = false; opp.survivalTime = 0; }
            } else if (evt.type === "game_ended") {
                // All done â€” we can just let natural game flow handle it
            }
        }

        // Bullets
        for (let i=bullets.length-1; i>=0; i--) {
            const b = bullets[i];
            const bx = b.obj.pos.x + b.vx * k.dt();
            const by = b.obj.pos.y + b.vy * k.dt();
            b.obj.pos = k.vec2(bx, by);
            if (bx < -70 || bx > GAME_W + 70 || by < -70 || by > GAME_H + 70) {
                k.destroy(b.obj); bullets.splice(i,1); continue;
            }
            const hitDist=(PLAYER_R-2)+(b.r-1);
            if (invinc<=0 && dist2(player.pos,b.obj.pos)<hitDist*hitDist) {
                k.destroy(b.obj); bullets.splice(i,1); playerHit(); continue;
            }
        }

        // Spawn
        spawnTimer+=k.dt();
        if (spawnTimer>=getSpawnInterval()) { spawnTimer=0; pickAndSpawn(); }

        updateHUD();
    });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GAME OVER SCENE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
k.scene("gameover", (data) => {
    joyHide();
    const { survTime=0, goldEarned=0, isMulti=false, opponentResults=[] } = data;
    const best    = getBest();
    const isNew   = survTime > best;
    const dispBest = isNew ? survTime : best;

    k.add([k.pos(GAME_W/2,GAME_H*0.11), k.anchor("center"),
        k.text("GAME  OVER",{size:34,font:"monospace"}), k.color(255,55,55)]);

    k.add([k.pos(GAME_W/2,GAME_H*0.24), k.anchor("center"),
        k.text("ë‚´ ìƒì¡´ ì‹œê°„",{size:13,font:"monospace"}), k.color(150,180,220)]);
    k.add([k.pos(GAME_W/2,GAME_H*0.33), k.anchor("center"),
        k.text(survTime.toFixed(1)+"ì´ˆ",{size:42,font:"monospace"}), k.color(255,220,50)]);

    if (isNew) {
        k.add([k.pos(GAME_W/2,GAME_H*0.42), k.anchor("center"),
            k.text("ğŸ‰ ì‹ ê¸°ë¡!",{size:18,font:"monospace"}), k.color(50,230,140)]);
    } else {
        k.add([k.pos(GAME_W/2,GAME_H*0.42), k.anchor("center"),
            k.text(`ğŸ† ìµœê³ : ${dispBest.toFixed(1)}ì´ˆ`,{size:15,font:"monospace"}), k.color(200,165,90)]);
    }

    // Multi results
    if (isMulti && opponentResults.length) {
        let yOff = GAME_H*0.50;
        k.add([k.pos(GAME_W/2,yOff), k.anchor("center"),
            k.text("â”€â”€ ìƒëŒ€ë°© â”€â”€",{size:12,font:"monospace"}), k.color(150,150,200)]);
        opponentResults.forEach(opp => {
            yOff += 22;
            const txt = opp.survivalTime != null
                ? `${opp.nickname}: ${opp.survivalTime.toFixed(1)}ì´ˆ`
                : `${opp.nickname}: í”Œë ˆì´ ì¤‘`;
            const won = opp.survivalTime != null && opp.survivalTime > survTime;
            k.add([k.pos(GAME_W/2,yOff), k.anchor("center"),
                k.text(txt+(won?" ğŸ†":""),{size:13,font:"monospace"}),
                k.color(...(won?[255,215,50]:[160,180,210]))]);
        });
    }

    if (goldEarned>0) {
        k.add([k.pos(GAME_W/2,GAME_H*0.64), k.anchor("center"),
            k.text(`ğŸ’° íšë“: ${goldEarned}G`,{size:15,font:"monospace"}), k.color(255,195,40)]);
    }

    // Buttons
    const retryBtn = k.add([k.rect(200,52), k.pos(GAME_W/2,GAME_H*0.74),
        k.anchor("center"), k.color(25,145,75), k.area(), "retryBtn"]);
    k.add([k.pos(GAME_W/2,GAME_H*0.74), k.anchor("center"),
        k.text("ğŸ”„ ë‹¤ì‹œí•˜ê¸°",{size:18,font:"monospace"}), k.color(255,255,255)]);

    const titleBtn = k.add([k.rect(180,44), k.pos(GAME_W/2,GAME_H*0.85),
        k.anchor("center"), k.color(45,65,110), k.area(), "titleBtn"]);
    k.add([k.pos(GAME_W/2,GAME_H*0.85), k.anchor("center"),
        k.text("ğŸ  íƒ€ì´í‹€ë¡œ",{size:15,font:"monospace"}), k.color(170,200,255)]);

    retryBtn.onClick(() => {
        if (isMulti) {
            // ë©€í‹° ì¬ë„ì „: ë¡œë¹„ë¡œ
            mp?.stopListening();
            MultiplayerClient.resetInstance();
            mp=null; mpRoomId=null; mpIsHost=false; mpContext=null; mpEventQueue.length=0;
            k.go("title");
            showLobby();
        } else {
            k.go("game", { mode:"1p", seed: Math.floor(Math.random()*0xFFFFFF) });
        }
    });
    titleBtn.onClick(() => {
        if (mp) {
            mp.stopListening();
            MultiplayerClient.resetInstance();
            mp=null; mpRoomId=null; mpIsHost=false; mpContext=null; mpEventQueue.length=0;
        }
        k.go("title");
    });
    k.onKeyDown("space", () => k.go("game", { mode:"1p", seed: Math.floor(Math.random()*0xFFFFFF) }));
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  START
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
k.go("title");
</script>
</body>
</html>
