# Catan 싱글 AI 대전 설계 (Rule-based)

## 목표
- 멀티 테스트 없이도 카탄을 **싱글플레이(나 + AI 2명)** 로 충분히 플레이 가능하게 만든다.
- AI는 랜덤이 아니라, 룰/휴리스틱 기반으로 최소한의 전략성을 가진다.

## 범위 (이번 배포)
- 포함:
  - 싱글 플레이어 구성: 인간 1 + AI 2
  - 초기 배치(setup): AI가 확률 높은 자리 선호
  - 메인 턴: 주사위 → (7 처리 포함) → 건설 우선순위
  - 강도(robber): 상대에게 피해가 큰 타일/대상 선호
- 제외:
  - 거래(은행/플레이어)
  - 발전 카드
  - 외부 LLM 호출

## AI 의사결정 원칙
1. **정착지/도시 자리 평가**
   - 주사위 확률(6/8 우선)
   - 자원 다양성 보너스
   - 곡물/광석 선호 가중치(도시 업그레이드 가속)
   - 강도 위치 패널티
2. **도로 배치**
   - setup에서는 방금 놓은 정착지에서 확장 가치가 높은 방향 우선
   - 메인에서는 내 네트워크 확장 + 고가치 정점 접근 가능성 우선
3. **메인 빌드 우선순위**
   - city > settlement > road
4. **강도 이동**
   - 현재 강도 칸 제외
   - 상대 건물(특히 city) + 생산 확률 + 희생자 자원량을 반영
   - 여러 상대를 동시에 압박 가능한 타일 보너스

## 구조
- `catan/ai.js`:
  - 순수 함수 중심 AI 모듈
  - 브라우저(window.CatanAI) + Node 테스트(module.exports) 동시 지원
- `catan/index.html`:
  - 기존 게임 상태/룰 엔진 유지
  - AI 턴에서만 `window.CatanAI` 호출

## 테스트 전략
- `catan/ai.test.cjs` (node:test)
  - 정착지 선택
  - setup 도로 선택
  - 강도 타겟 선택
  - 빌드 우선순위
- 테스트 실행: `node --test catan/ai.test.cjs`

## 성공 기준
- 싱글 시작 시 3인(나+AI2) 정상 구성
- AI가 턴을 멈추지 않고 자동 진행
- 강도/건설 행동이 랜덤보다 일관된 전략성을 보임
- AI 단위 테스트 통과
